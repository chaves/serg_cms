const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["strapi-Bqijykrh.js","strapi-D6821bIJ.css"])))=>i.map(i=>d[i]);
import{r as f,ah as T,dK as D,aD as A,q as C,dL as B,bW as F,a1 as O,a as w,b as U,b7 as R,ch as K,j as s,dM as l,bL as G,dN as H,n as W,aj as V,b3 as $,dO as q,P as N,b8 as Z,K as z,au as J,dm as E,bU as Q,dP as X}from"./strapi-Bqijykrh.js";import{s as Y}from"./sortBy-BtFMPpU2.js";import{s as ss}from"./selectors-BnJm7gXF.js";import"./_baseMap-DhmARHhS.js";import"./_baseEach-Bq7_pUyV.js";const es=i=>i.map(o=>{const n=o.links.map(r=>({...r,isDisplayed:!1}));return{...o,links:n}}),_=()=>{const[{isLoading:i,menu:o},n]=f.useState({isLoading:!0,menu:[]}),r=T("useSettingsMenu",t=>t.checkUserHasPermissions),u=D("useSettingsMenu",t=>t.shouldUpdateStrapi),m=A("useSettingsMenu",t=>t.settings),g=C(ss),x=f.useMemo(()=>B(),[]),{admin:L,global:p}=F(x,async()=>(await O(async()=>{const{SETTINGS_LINKS_EE:t}=await import("./strapi-Bqijykrh.js").then(e=>e.pZ);return{SETTINGS_LINKS_EE:t}},__vite__mapDeps([0,1]))).SETTINGS_LINKS_EE(),{combine(t,e){return{admin:[...e.admin,...t.admin],global:[...t.global,...e.global]}},defaultValue:{admin:[],global:[]}}),d=f.useCallback(t=>{if(!t.id)throw new Error("The settings menu item must have an id attribute.");return{...t,permissions:g.settings?.[t.id]?.main??[]}},[g.settings]);return f.useEffect(()=>{const t=async()=>{const v=await(S=>Promise.all(S.reduce((b,j,M)=>{const P=j.links.map(async(k,h)=>({hasPermission:(await r(k.permissions)).length>0,sectionIndex:M,linkIndex:h}));return[...b,...P]},[])))(y);n(S=>({...S,isLoading:!1,menu:y.map((b,j)=>({...b,links:b.links.map((M,P)=>{const k=v.find(h=>h.sectionIndex===j&&h.linkIndex===P);return{...M,isDisplayed:!!k?.hasPermission}})}))}))},{global:e,...a}=m,y=es([{...e,links:Y([...e.links,...p.map(d)],c=>c.id).map(c=>({...c,hasNotification:c.id==="000-application-infos"&&u}))},{id:"permissions",intlLabel:{id:"Settings.permissions",defaultMessage:"Administration Panel"},links:L.map(d)},...Object.values(a)]);t()},[L,p,m,u,d,r]),{isLoading:i,menu:o.map(t=>({...t,links:t.links.filter(e=>e.isDisplayed)}))}},ts=W(V)`
  border-radius: 50%;
  padding: ${({theme:i})=>i.spaces[2]};
  height: 2rem;
`,I=({isFullPage:i=!1})=>{const{menu:o}=_(),{formatMessage:n}=w(),{trackUsage:r}=U(),{pathname:u}=R(),{license:m}=K(),g=m?.features.map(e=>e.name),x={"content-releases":"cms-content-releases","review-workflows":"review-workflows",sso:"sso",auditLogs:"audit-logs","auditLogs-purchase-page":"audit-logs"},p=o.filter(e=>!e.links.every(a=>a.isDisplayed===!1)).map(e=>({...e,title:e.intlLabel,links:e.links.map(a=>({...a,id:a.id,title:a.intlLabel,name:a.id,to:a.to.startsWith("/")?a.to:`/settings/${a.to}`}))})),d=n({id:"global.settings",defaultMessage:"Settings"}),t=e=>()=>{r("willNavigate",{from:u,to:e})};return s.jsxs(l.Main,{"aria-label":d,children:[!i&&s.jsxs(s.Fragment,{children:[s.jsx(l.Header,{label:d}),s.jsx(G,{})]}),s.jsxs(l.Content,{children:[i&&s.jsx(l.Header,{label:d}),s.jsx(l.Sections,{children:p.map(e=>s.jsx(l.Section,{label:n(e.intlLabel),children:e.links.map(a=>s.jsx(l.Link,{to:a.to,onClick:t(a.to),label:n(a.intlLabel),endAction:s.jsxs(s.Fragment,{children:[a?.licenseOnly&&s.jsx(H,{fill:(g||[]).includes(x[a.id])?"primary600":"neutral300",width:"1.5rem",height:"1.5rem"}),a?.hasNotification&&s.jsx(ts,{"aria-label":"Notification",backgroundColor:"primary600",textColor:"neutral0",children:"1"})]}),children:n(a.intlLabel)},a.id))},e.id))})]})]})},ls=()=>{const i=$("/settings/:settingId/*"),{formatMessage:o}=w(),{isLoading:n}=_(),r=q();return n?s.jsx(N.Loading,{}):i?.params.settingId?s.jsxs(z.Root,{sideNav:s.jsx(I,{}),children:[s.jsx(N.Title,{children:o({id:"global.settings",defaultMessage:"Settings"})}),s.jsx(J,{display:{initial:"block",medium:"none"},paddingLeft:E,paddingRight:E,paddingTop:E,children:s.jsx(Q,{fallback:"/settings"})}),s.jsx(X,{})]}):r?s.jsxs(s.Fragment,{children:[s.jsx(N.Title,{children:o({id:"global.settings",defaultMessage:"Settings"})}),s.jsx(l.PageWrapper,{children:s.jsx(I,{isFullPage:!0})})]}):s.jsx(Z,{to:"application-infos"})};export{ls as Layout};
