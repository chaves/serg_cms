import{r as c,g as f,j as t,R as I,H as p,T as O}from"./strapi-Bqijykrh.js";import{u as V}from"./index-lc15AWNW.js";const k=r=>{if(r.includes("vimeo")){const s=/^https?:\/\/(?:www\.)?vimeo\.com\/(?:(?:channels\/[\w]+\/)|(groups\/[\w]+\/videos\/))?(\d+)(?:\/([\w]+))?/,o=r.match(s);if(o&&o[1])return{provider:"vimeo",providerUid:o[1],privacyHash:o[2]||null}}if(r.includes("youtube")||r.includes("youtu.be")){const s=/^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\/)|(\?v=|\&v=))([^#\&\?]{11}).*/,o=/youtube\.com\/shorts\/([a-zA-Z0-9_-]{11})/,a=r.match(s);if(a&&a[8].length===11)return{provider:"youtube",providerUid:a[8]};const d=r.match(o);if(d&&d[1])return{provider:"youtube",providerUid:d[1]}}return r.includes("facebook")?{provider:"facebook",providerUid:r}:null},F=({attribute:r,name:s,onChange:o,value:a,intlLabel:d,intlDescription:h})=>{const[u,y]=c.useState(null),[g,m]=c.useState(null),[v,w]=c.useState(null),[x,b]=c.useState(null),[U,n]=c.useState(!1),{formatMessage:l}=V();c.useEffect(()=>{let e;if(typeof a=="object")e=a;else try{e=JSON.parse(a)}catch{e={}}e?.privacyHash&&m(e.privacyHash),e?.url&&(b(e.url),e.provider&&e.providerUid?(n(!1),w(e.provider),y(e.providerUid)):n(!0))},[a]);const j=e=>{if(b(e.target.value||""),e.target.value){const i=k(e.target.value);e.target.value.length>0&&n(!0),i?.provider&&i?.providerUid&&(n(!1),w(i.provider),y(i.providerUid)),i?.privacyHash&&m(i.privacyHash);const P={url:e.target.value,provider:i?.provider||"",providerUid:i?.providerUid||"",privacyHash:i?.privacyHash||""};o({target:{name:s,value:JSON.stringify(P),type:r.type}})}else n(!1),o({target:{name:s,value:JSON.stringify({url:"",provider:void 0,providerUid:void 0,privacyHash:void 0}),type:r.type}})},H=l(d||{id:f("video-field.label"),defaultMessage:"Video"}),S=l(h||{id:f("video-field.title"),defaultMessage:"Video url"}),E=l({id:f("video-field.placeholder"),defaultMessage:"eg. https://vimeo.com/123456789"}),M=l({id:f("video-field.invalid.url"),defaultMessage:"Invalid video url"});return t.jsxs(I,{children:[t.jsxs(p.Root,{id:s,hint:S,error:U?M:void 0,children:[t.jsx(p.Label,{children:H}),t.jsx(p.Input,{type:"text",name:s,value:x,onChange:j,placeholder:E}),t.jsx(p.Hint,{}),t.jsx(p.Error,{})]}),v&&u&&t.jsxs(O,{paddingTop:4,justifyContent:"center",children:[v==="vimeo"&&t.jsx("iframe",{src:`https://player.vimeo.com/video/${u}${g?"/"+g:""}`,referrerPolicy:"strict-origin-when-cross-origin",allow:"autoplay; fullscreen; picture-in-picture",allowFullScreen:!0,height:200,style:{border:0}}),v==="youtube"&&t.jsx("iframe",{src:`https://www.youtube-nocookie.com/embed/${u}`,referrerPolicy:"strict-origin-when-cross-origin",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,height:200,style:{border:0}}),v==="facebook"&&t.jsx("iframe",{src:`https://www.facebook.com/plugins/video.php?href=${u}&show_text=false&t=0`,referrerPolicy:"strict-origin-when-cross-origin",allow:"autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share",allowFullScreen:!0,height:200,style:{border:0}})]})]})};export{F as default};
