import{d6 as y,j as e,de as A,df as g,di as d,da as o,gG as x,gH as O,gI as b,gJ as T,gK as u,cX as $,gL as H,d4 as B,b as z,B as F,gM as G,r as j,K as c,P as W,db as _,d9 as P,dc as J,gN as K,b1 as U,gO as q,gP as V,c9 as X}from"./strapi-CDBlFoOX.js";const Y=({sort:i="",pageSize:s=10,onChange:a})=>{const{formatMessage:n}=y();return e.jsx(A,{background:"neutral0",hasRadius:!0,shadow:"tableShadow",paddingTop:6,paddingBottom:6,paddingLeft:7,paddingRight:7,children:e.jsxs(g.Root,{gap:4,children:[e.jsx(g.Item,{xs:12,m:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.entries.note"),defaultMessage:"Number of assets displayed by default in the Media Library"}),name:"pageSize",children:[e.jsx(d.Label,{children:n({id:o("config.entries.title"),defaultMessage:"Entries per page"})}),e.jsx(x,{onChange:t=>a({target:{name:"pageSize",value:t}}),value:s,children:O.map(t=>e.jsx(b,{value:t,children:t},t))}),e.jsx(d.Hint,{})]})}),e.jsx(g.Item,{xs:12,m:6,direction:"column",alignItems:"stretch",children:e.jsxs(d.Root,{hint:n({id:o("config.note"),defaultMessage:"Note: You can override this value in the media library."}),name:"sort",children:[e.jsx(d.Label,{children:n({id:o("config.sort.title"),defaultMessage:"Default sort order"})}),e.jsx(x,{onChange:t=>a({target:{name:"sort",value:t}}),value:i,"test-sort":i,"data-testid":"sort-select",children:T.map(t=>e.jsx(b,{"data-testid":`sort-option-${t.value}`,value:t.value,children:n({id:o(t.key),defaultMessage:`${t.value}`})},t.key))}),e.jsx(d.Hint,{})]})})]})})},D=`${u}/ON_CHANGE`,v=`${u}/SET_LOADED`,Q=({name:i,value:s})=>({type:D,keys:i,value:s}),Z=()=>({type:v}),f={initialData:{},modifiedData:{}},S=i=>({...f,initialData:i,modifiedData:i}),ee=(i=f,s={type:""})=>$(i,a=>{switch(s.type){case D:{"keys"in s&&"value"in s&&s.keys&&B(a,["modifiedData",...s.keys.split(".")],s.value);break}case v:{const n=S(H(a,["modifiedData"],{}));a.initialData=n.initialData,a.modifiedData=n.modifiedData;break}default:return a}}),ae=({config:i})=>{const{trackUsage:s}=z(),{formatMessage:a}=y(),{toggleNotification:n}=F(),{mutateConfig:t}=G(),{isLoading:M}=t,[C,h]=j.useState(!1),m=()=>h(r=>!r),[k,L]=j.useReducer(ee,f,()=>S(i)),p=L,{initialData:w,modifiedData:l}=k,E=r=>{r.preventDefault(),m()},R=async()=>{s("willEditMediaLibraryConfig"),await t.mutateAsync(l),h(!1),p(Z()),n({type:"success",message:a({id:"notification.form.success.fields",defaultMessage:"Changes saved"})})},I=({target:{name:r,value:N}})=>{p(Q({name:r,value:N}))};return e.jsx(c.Root,{children:e.jsx(W.Main,{"aria-busy":M,children:e.jsxs("form",{onSubmit:E,children:[e.jsx(c.Header,{navigationAction:e.jsx(K,{tag:U,startIcon:e.jsx(q,{}),to:`/plugins/${u}`,id:"go-back",children:a({id:o("config.back"),defaultMessage:"Back"})}),primaryAction:e.jsx(_,{size:"S",startIcon:e.jsx(J,{}),disabled:P(l,w),type:"submit",children:a({id:"global.save",defaultMessage:"Save"})}),subtitle:a({id:o("config.subtitle"),defaultMessage:"Define the view settings of the media library."}),title:a({id:o("config.title"),defaultMessage:"Configure the view - Media Library"})}),e.jsx(c.Content,{children:e.jsx(Y,{"data-testid":"settings",pageSize:l.pageSize||"",sort:l.sort||"",onChange:I})}),e.jsx(V.Root,{open:C,onOpenChange:m,children:e.jsx(X,{onConfirm:R,variant:"default",children:a({id:o("config.popUpWarning.warning.updateAllSettings"),defaultMessage:"This will modify all your settings"})})})]})})})};export{ae as ConfigureTheView};
